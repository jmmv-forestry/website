---
title: "Monotone's help rewrite"
date: 2007-04-23 05:54:00 -0400
categories:
  - "monotone"
julipedia: 2007/04/monotones-help-rewrite.html
slug: monotones-help-rewrite
---
A couple of weeks ago, I updated <a href="http://monotone.ca/">Monotone</a> to 0.34 and noticed a small style problem in the help output: the line wrapping was not working properly, so some words got cut on the terminal's boundary.  After <a href="http://viewmtn.angrygoats.net/revision/info/7c164c4ba32563a1e781e55c89352c04e5019348">resolving this minor issue</a>, I realized that I didn't know what most of the commands shown in the main help screen did.  Virtually all other command-line utilities that have integrated help show some form of an abstract description for each command which allows the novice to quickly see what they are about.  So why wouldn't Monotone?<br /><br />I started extending the internal commands interface to accept a little abstract for each command and command group, to be later shown in the help output.  This was rather easy, and I posted some preliminary changes in <a href="http://lists.gnu.org/archive/html/monotone-devel/2007-04/msg00039.html">to the mailing list</a>.  But you know what happens when proposing trivial changes...<br /><br />People complained that the new output was too long to be useful, which I agreed on and fixed by only showing commands in a given group at a time.  But... there was also an interesting request: allow the documentation of subcommands (e.g. <tt>list keys</tt>) in a consistent way with how primary commands (e.g. <tt>checkout</tt>) are defined.  There is even a bug (<a href="https://savannah.nongnu.org/bugs/?18281">#18281</a>) about this issue.<br /><br />And... that has kept me busy for way longer than I expected.  I've ended up rewriting the way commands are defined internally by constructing a <i>tree of commands</i> instead of a <i>plain list</i>.  This allows the generic command lookup algorithm to locate commands at any level in the tree, thus being able to standarize the way to define help and options on them.<br /><br />The work is almost done and can be seen in the <a href="http://viewmtn.angrygoats.net/branch/changes/net.venge.monotone.help-rewrite">net.venge.monotone.help-rewrite</a> branch.<br /><br />I've also been messing with <a href="http://git.or.cz/cogito/">Cogito</a> recently and found some of its user interface features to be very convenient.  These include automatic paging of long output and colored diffs straight on the console.  Something to borrow from them if I ever have the time for it, I guess ;-)
