---
title: "SoC: Status report"
date: 2007-08-15 13:43:00 -0400
categories:
  - "atf"
  - "soc"
julipedia: 2007/08/soc-status-report.html
excerpt_separator: </p>
slug: soc-status-report
---
SoC's deadline is just five days away!  I'm quite happy with the status of my project, <a href="http://netbsd-soc.sourceforge.net/projects/atf/">ATF</a>, but it will require a lot more work to be in a decent shape — i.e. ready to be imported into NetBSD — and there really is no time to get it done in five days.  Furthermore, it is still to unstable (in the sense that it changes a lot) so importing it right now could cause a lot of grief to end users.  However, after a couple of important changes, it may be ready for a 0.1 release, and that's what I'm aiming for.<br /><br />I have to confess again that some parts of the code are horrible.  That's basically because it has been gaining features in an iterative way, all which were not planned beforehand... so it has ended up being hack over hack.  But, don't worry: as long as there is good test coverage for all the expected features, this can easily be fixed.  With a decent test suite, I'll be able to later rewrite any piece of code and be pretty sure that I have not broken anything important.  (In fact, I've already been doing that for the most inner code with nice results.)<br /><br />So what has changed since the <a href="http://julipedia.blogspot.com/2007/08/soc-first-preview-of-netbsd-with-atf.html">preview</a>?<br /><ul><li>All files read by ATF as well as all data formats used for serialization of data have now a header that specifies their format (a type and a version).  This is very important to have from the very beginning so that the data formats can easily be changed in the future (which will certainly happen).</li><li>Rewrote how test programs and <tt>atf-run</tt> print their execution status.  Now, the two print a format that is machine-parseable and which is "sequential": reading the output from top to bottom, you can immediately know what the program is doing at the moment without having to wait for future data.</li><li>Added the <tt>atf-report</tt> tool, which gathers the output of <tt>atf-run</tt> and generates a user-friendly report.  At the moment it outputs plain text only, but XML (and maybe HTML) are planned.  The previous point was a pre-requisite for this one.</li><li>Merged multiple implementation files into more generic modules.</li><li>Merged the libatf and libatfprivate libraries into a single one.  The simpler the better.</li><li>Added build-time tests for all public headers, to ensure that they can be included without errors.</li><li>Implemented run-time configuration variables for test programs and configuration files.</li></ul>Wow, that's a lot of stuff :-)<br /><br />And talking with my mentor five days ago, we got to the following list of pending work to get done before the deadline:<br /><ol><li>Configuration files.  Already done as of an hour ago!</li><li>A plain text format that clearly describes the results of the test cases (similar to what <tt>src/regress/README</tt> explains).  I haven't looked at that yet, but this will be trivial with the new <tt>atf-report</tt> tool.</li><li>Would be nice: HTML output.  Rather easy.  But I'm unsure about this point: it may be better to define a XML format only and then use xsltproc to transform it.</li><li>Manual pages: A must for 0.1 (even if they are not too detailed), but not really required for the evaluation.</li><li>Code cleanups: Can be done after SoC, but I personally dislike showing ugly code.  Unfortunately there is not enough time to spend on this.  Cleaning up a module means: rewriting most of it, documenting each function/class and adding exhaustive unit tests for it.  It is painful, really, but the results are rewarding.<br /></li><li>Keep the NetBSD patches in sync with development: I'm continuously doing that!</li></ol>Let's get back to work.
