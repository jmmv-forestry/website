---
title: "Alternatives system in pkgsrc"
date: 2005-01-19 18:12:00 -0500
julipedia: 2005/01/alternatives-system-in-pkgsrc.html
excerpt_separator: </p>
---
<p>Inspired by the recent comments of a user, I decided to implement an <i>alternatives system</i> for <a href="http://www.pkgsrc.org/">pkgsrc</a>, similar to the one used by <a href="http://www.debian.org/">Debian</a>. The purpose of this framework is to manage symbolic links that point to specific programs from a group of utilities with similar behavior.</p>  <p>The easiest example to show what this means comes when looking at <a href="http://www.vim.org/">Vim</a> and <a href="http://www.bostic.com/vi/">Nvi</a>. Both editors can be generally installed on the same system without conflicts. However, in that case, the system still misses a generic name, such as <tt>vi</tt>, to launch one as the default editor for the system. The administrator can make that link by hand, but couldn't it be nice if the system itself created it for you?</p>  <p>Alternatives come to improve this situation: multiple packages register themselves as providers for a set of links with a generic name (which I have named as <i>class</i>). The administrator is then free to choose which one should be the default, and the system adjusts the symbolic links to point to the preferred utility. This even works in an unattended manner, because the packages adjust the links at (de)installation if needed.</p>  <p>This is, of course, applicable to many other situations.  Consider <a href="http://java.sun.com/">Java</a> virtual machines, MTAs, window managers, <a href="http://www.python.org/">Python</a> interpreters, etc. In fact, I hope that this will simplify some stuff that we already have in pkgsrc to handle wrappers to run Java (i.e., <a href="http://cvsweb.netbsd.org/bsdweb.cgi/pkgsrc/lang/java-wrapper/">lang/java-wrapper</a> or Python, in a more flexible way.</p>  <p>So let's look at how this actually works from the point of view of a package (in this case, <a href="http://cvsweb.netbsd.org/bsdweb.cgi/pkgsrc/editors/nvi/">editors/nvi</a>):</p>  <pre>ALTERNATIVE_CLASSES=   vi <p>ALTERNATIVE_NAME.vi=   nvi</p> <p>ALTERNATIVE_FILES.vi=  ${PREFIX}/bin/vi ${PREFIX}/bin/nvi</p> <p>ALTERNATIVE_FILES.vi+= ${PREFIX}/man/man1/vi.1 ${PREFIX}/man/man1/nvi.1</p></pre><p></p>  <p>Simple, eh? ;-)  This is internally handled by the new utility, <tt>pkg_alternatives</tt>, which is not yet finished. I hope it'll be ready tomorrow. Note that this is still not committed to the tree; in fact, I don't even know if other developers will be against it. Anyway, more on this on the next post.</p>  <p><b>Edit (20th Jan, 10:39)</b>: I've had to change the semantics of the Makefile variables to allow more flexibility, so I've adjusted the example above accordingly.</p><p class="mobile-post"></p>
