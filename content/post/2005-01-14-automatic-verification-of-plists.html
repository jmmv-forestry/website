---
title: "Automatic verification of PLISTs"
date: 2005-01-14 17:23:00 -0500
julipedia: 2005/01/automatic-verification-of-plists.html
excerpt_separator: </p>
slug: automatic-verification-of-plists
---
<a href="http://www.pkgsrc.org/">pkgsrc</a> uses static file lists to register the contents of an installed package. A drawback of this approach is that the file list of a package may occasionally become out of sync with reality. I.e., it may omit some files that are really installed, thus leaving them orphaned, or specify extra files that are not really copied into place. <p>There are multiple reasons that can cause this desynchronization, including careless updates, incorrect detection of dependencies or, even worse, files that are only installed depending on the OS you are running. When some files are not properly installed, pkgsrc can easily tell you that an error happened, because it will not find all the files listed in the static list. However, the opposite situation is hard to detect, and it was not possible up until now.</p>  <p>Yesterday, I looked at the stale files left after a bulk build under Linux and I was quite disappointed because the list was not anything close to short. So I decided to add a mechanism to capture these problems as soon as possible. You can benefit from these changes with recent pkgsrc's HEAD as of today's evening.</p>  <p>The new feature, called <i>check-files</i> is only run when <tt>PKG_DEVELOPER</tt> is defined and <tt>CHECK_FILES</tt> is set to <tt>YES</tt>. The later is a default (though it might be changed if it continues to show flaws). This will ensure that any package does not install more files than expected.</p>  <p>There is also some extra functionality that is only enabled when <tt>CHECK_FILES_STRICT</tt> is set to <tt>YES</tt> (not a default).  In this case, <i>check-files</i> will ensure that packages do <i>not</i> touch <tt>PKG_SYSCONFDIR</tt> nor <tt>VARBASE</tt> <i>directly</i>.  This behavior is completely incorrect from the point of view of binary packages, as they have to use <tt>bsd.pkg.install.mk</tt> for correct operation. However, these checks cannot be turned on by default (yet) because they will break many packages. Even though, developers should turn on this strict behavior and fix their packages whenever possible.</p><p class="mobile-post"></p>
