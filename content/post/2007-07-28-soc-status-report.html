---
title: "SoC: Status report"
date: 2007-07-28 04:07:00 -0400
categories:
  - "atf"
  - "soc"
julipedia: 2007/07/soc-status-report.html
excerpt_separator: </p>
slug: soc-status-report
---
It has already been a week since the <a href="http://julipedia.blogspot.com/2007/07/soc-atf-self-testing.html">last SoC-related post</a>, so I owe you an status report.<br /><br />Development has continued at a constant rate and, despite I work a lot on the project, it may seem to advance slowly from an external point of view.  The thing is that getting the ATF core components complete and right is a tough job!  Just look at the <a href="http://mtn-host.prjek.net/viewmtn/atf/revision/file/1e5eacfc5e17dffcf1c5c64cb781c770b68d1d35/TODO">current and incomplete TODO list </a>to see what I mean.<br /><br />Some things worth to note:<br /><ul><li>The NetBSD cross-build tool-chain no longer requires a C++ compiler to build the atf-compile host tool.  I wrote a simplified version in POSIX shell to be used as the host tool alone (not to be installed).  This is also used by the ATF's distfile to allow "cross-building" its own test programs.<br /></li><li>Improved the cleanup procedure of the test case's work directories by handling mount points in them.  This is done through a new tool called atf-cleanup.</li><li>Added a property to allow test cases specify if they require root privileges or not.<br /></li><li>Many bug fixes, cleanups and new test cases; these are driving development right now.</li></ul>On the NetBSD front, there have also been several cosmetic improvements and bug fixes, but most importantly I've converted the <a href="http://cvsweb.netbsd.org/bsdweb.cgi/src/regress/sys/fs/tmpfs/">tmpfs' test suite</a> to ATF.  This conversion is what has spotted many bugs and missing features in ATF's code.  The TODO file has grown basically due to this.<br /><br />So, at the moment, both the <tt>regress/bin</tt> and <tt>regress/sys/fs/tmpfs</tt> trees in NetBSD have been converted to ATF.  I think that's enough for now and that I should focus on adding the necessary features to ATF to improve these tests.  One of these is to add support for a configuration file to let the user specify how certain tests should behave; e.g. how to become root or which specific file system to use for certain tests.<br /><br />I also have a partial implementation to add a "fork" property to test cases to execute them in subprocesses.  This way they will be able to mess all they want with the open file descriptors without disturbing the main test program.  But to get here, I first need to clean up the reporting of test case's results.<br /><br />On the other hand, I also started preparing manual pages for the user tools as some of them should remain fairly stable at this point.
