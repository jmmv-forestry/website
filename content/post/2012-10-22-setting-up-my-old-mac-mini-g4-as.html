---
title: "Setting up my old Mac Mini G4 as a development machine"
date: 2012-10-22 15:31:00 -0400
categories:
  - "kyua"
  - "mac"
  - "netbsd"
julipedia: 2012/10/setting-up-my-old-mac-mini-g4-as.html
slug: setting-up-my-old-mac-mini-g4-as
---
I've spent quite a few time last week setting up my old Mac Mini G4 — a PPC 1.2GHz with 1GB of RAM running NetBSD/macppc current — as a "workstation" for the development of Kyua and other tools for NetBSD. Yes, this machine is very slow, but that's the whole point of the exercise I'm going to narrate below.<br /><br />I recently got approval from the NetBSD core team to import Kyua into the NetBSD source tree and replace ATF with it... which is great, but when thinking about it objectively, I am reluctant to unnecessarily "punish" all NetBSD users by increasing the build time of the system significantly. Don't get me wrong: Kyua itself <i>runs</i>&nbsp;efficiently on old machines, but <i>building</i> the code — particularly the hundreds of tests that come with it — takes just too long. This slowdown is not too noticeable on a relatively-modern machine, but it's unacceptable on not-so-old machines.<br /><br />Of course, I could proceed with the import right now (with the code disabled by default) and make it leaner later, but this would cause quite a first bad impression on our users. So it's better to delay the import a little bit until, at least, I have had a chance to simplify some core parts of the code. Mind you, this simplification work is already in progress and quite advanced: it consists on modularizing (as separate processes) some critical parts of the code and writing these with a much simpler style and in plain C.<br /><br />But back to the original point of my post.<br /><br />The first thing to mention about this experience is that with some effort and long waits, I've got a pretty decent setup for development even on this old machine. From time to time, I miss having a real Unix desktop at hand for development (no OS X, you are not one of those). The GUI behaves relatively well with a 1920x1200 display, running Fluxbox, traditional xterms, Mutt for GMail access and a bunch of other applications.<br /><br />Unfortunately, too many things feel really sluggish. A few specific examples:<br /><br /><ul><li>Firefox 16 is barely usable. I'm not sure there are many alternatives to decent web browsing for such an old non-Intel platform. Dillo is blazing fast and allows me to access online documentation and mailing list archives (just enough for development), but it's pretty much useless for any other purpose given the "Web 2.0".</li><li>Any operation that involves pkgsrc takes ages. Even when building the simplest packages, one can notice the system crawl through all of the pkgsrc infrastructure. Sometimes this is the fault of&nbsp;<a href="http://mail-index.netbsd.org/pkgsrc-changes/2012/10/13/msg079664.html">a bad algorithm</a>; other times it's just sh(1) being the wrong tool for something as complex as pkgsrc internals.</li><li>Things like basic code editing in Emacs 24 are slow at responding to typing. Disabling font lock mode makes it feel fast again, but it's just surprising to see that even color coding is slow.</li></ul>I still remember my old and trusty machine from 10 years ago (a Pentium II 233 MHz): with a similar setup, it was significantly snappier. Yes, software has evolved and these packages now have many more features... but really, does editing a text file have to be sluggish?<div><div><br /></div><div>Leaving aside sluggishness, there is also the problem of instability. NetBSD/macppc is a <a href="http://www.netbsd.org/ports/#ports-tier2">tier 2 port</a>, and things don't work as well as one would like. I personally would enjoy bringing this port to tier 1... but I currently lack the time (and basic knowledge of the architecture) to do so :-/</div><div><br /></div><div>Anyway, the result of this exercise: the new code I'm writing to modularize Kyua builds damn fast in this machine, and keeping it this way is <a href="http://blogs.msdn.com/b/oldnewthing/archive/2012/01/02/10252333.aspx">the whole point of having such an old machine as a build environment</a>. So I'll try to keep using it to develop these new components of Kyua.</div></div>
