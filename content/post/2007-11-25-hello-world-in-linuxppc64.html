---
title: "Hello world in Linux/ppc64"
date: 2007-11-25 12:22:00 -0500
categories:
  - "cell"
  - "linux"
  - "powerpc"
julipedia: 2007/11/hello-world-in-linuxppc64.html
slug: hello-world-in-linuxppc64
---
I'm decided to improve my knowledge on the Cell platform, and the best way to get started seems to be to learn 64-bit PowerPC assembly given that the PPU uses this instruction set.  Learning this will open the door to do some more interesting tricks with the architecture's low-level details.<br /><br />There are some excellent articles at <a href="http://www.ibm.com/developerworks/">IBM developerWorks</a> dealing with this subject, and thanks to the <a href="http://www.ibm.com/developerworks/library/l-powasm1.html">first one in an introductory series to PPC64</a> I've been able to write the typical hello world program :-)<br /><br />Without further ado, here is the code!<pre>#<br /># The program's static data<br />#<br /><br />.data<br /><br />msg:    .string "Hello, world!n"<br />        length = . - msg<br /><br />#<br /># Special section needed by the linker due to the C calling<br /># conventions in this platform.<br />#<br /><br />.section ".opd", "aw"               # aw = allocatable/writable<br /><br />.global _start<br />_start:<br />        .quad ._start, .TOC.@tocbase, 0<br /><br />#<br /># The program's code<br />#<br /><br />.text<br /><br />._start:<br />        li      0, 4                # write(2)<br />        li      3, 1                # stdout file descriptor<br />        lis     4, msg@highest      # load 64-bit buffer address<br />        ori     4, 4, msg@higher<br />        rldicr  4, 4, 32, 31<br />        oris    4, 4, msg@h<br />        ori     4, 4, msg@l<br />        li      5, length           # buffer length<br />        sc<br /><br />        li      0, 1                # _exit(2)<br />        li      3, 0                # return success<br />        sc</pre>You can build it with the following commands:<pre>$ as -a64 -o hello.o hello.s<br />$ ld -melf64ppc -o hello hello.o</pre>I'm curious about as(1)'s <tt>-a</tt> option; its purpose is pretty obvious, but it is not documented anywhere in the manual page nor in the info files.<br /><br />Anyway, back to coding!  I guess I'll post more about this subject if I find interesting and/or non-obvious things that are not already documented clearly anywhere.  But for beginner's stuff you already have the articles linked above.
