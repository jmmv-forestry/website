---
title: "SoC: Getting started"
date: 2007-06-24 11:57:00 -0400
categories:
  - "atf"
  - "netbsd"
  - "soc"
julipedia: 2007/06/soc-getting-started.html
slug: soc-getting-started
---
This weekend I have finally been able to start coding for my SoC project: the <a href="http://netbsd-soc.sourceforge.net/projects/atf/">Automated Testing Framework</a> for NetBSD.  To my disliking, this has been delayed too much... but I was so busy with my PFC that I couldn't find any other chance to get my hands on it.<br /><br />I've started by working on two core components:<br /><ul><li><span style="font-style: italic;">libatf</span>: The C/C++ library that will provide the interface to easily write test cases and test suites.  Among its features will be the ability to report the results of each test, a way to define meta-data for each test, etc.<br /></li><li><span style="font-style: italic;">libatfmain</span>: A library that provides a default entry point for test programs that takes care to run the test cases in a controlled environment &mdash; e.g. it captures all signals and deals with them gracefully &mdash; and provides a standard command-line interface for them.</li></ul>Soon after I started coding, I realized that I could need to write my own C code to deal with data collections and safe strings.  I hate that, because that's a very boring task &mdash; it is not related to the problem at hand at all &mdash; and because it involves reinventing the wheel: virtually all other languages provide these two features for-free.  But wait!  NetBSD has a C++ compiler, and atf won't be a host tool<sup>1</sup>.  So... I can take advantage of C++, and I'll try to.  Calm down!  I'll try to avoid some of the "complex" C++ features as much as possible to keep the executables' size small enough.  You know how the binaries' size blows up when using templates...  Oh, and by the way: keep in mind that test cases will be typically written in POSIX shell script, so in general you won't need to deal with the C++ interface.<br /><br />Furthermore, I see no reason for atf to be tied to NetBSD.   The test cases will surely be, but the framework needn't.  Thus I'm thinking of creating a standalone package for atf itself and distributing it as a completely independent project (under the TNF<sup>2</sup> umbrella), which will later be imported into the NetBSD source tree as we currently do for other third-party projects such as Postfix.  In fact, I've already started work on this direction by creating the typical infrastructure to use the GNU auto-tools.  Of course this separation could always be done at a later step in the development, but doing it from the very beginning ensures the code is free of NetBSD-isms, emphasizes the portability desire and keeps the framework self-contained.<br /><br />I'd like to hear your comments about these "decisions" :-)<br /><br /><sup>1</sup> A <span style="font-style: italic;">host tool</span> is a utility that is built with the operating system's native tools instead of with the NetBSD's tool-chain: i.e. host tools are what <tt>build.sh tools</tt> builds.  Such tools need to be highly portable because they have to be accepted by old compilers and bizarre build environments.<br /><br /><sup>2</sup> TNF = The NetBSD Foundation.
