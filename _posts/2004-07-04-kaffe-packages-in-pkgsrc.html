---
layout: post
title: "The Kaffe packages in pkgsrc"
date: 2004-07-04 12:47:00 -0400
categories:
julipedia: 2004/07/kaffe-packages-in-pkgsrc.html
excerpt: Post imported from The Julipedia; excerpt not available.
---
<p>At last!  I'm able to go through my TODO list and work on the items in it :-)  Today I've chosen one that said "<i>Improve the <a href="http://www.kaffe.org/">Kaffe</a> packages</i>" (in <a href="http://www.pkgsrc.org/">pkgsrc</a>).  I'm going to explain why they were wrong from pkgsrc's point of view and needed to be changed.</p>  <p>Until today, there were two packages for Kaffe, both mutually exclusive: <code>kaffe-nox11</code>, which provided kaffe built without AWT support, and <code>kaffe</code>, which provided everything. Conflicting packages should be avoided where possible, as they are a PITA for the end user. For example, suppose you have installed <code>kaffe-nox11</code> and a bunch of packages that depend on it, only to realize later that you need to run AWT applications.</p>  <p>Furthermore, there was a Makefile knob, <code>USE_ESOUND</code> to enable or disable sound support during the build. Why is this wrong? Because it only works when installing from sources. Users installing from binary packages (me, for example, on my server) won't have a choice: they'll have to use whatever the package builder decided, be it with esound or without it.</p>  <p>In some scenarios, it's impossible to go another way, specially if the package builds a single, monolithic binary program (like, unfortunately, <a href="http://www.mplayerhq.hu/">mplayer</a>).  But Kaffe is different: both AWT and sound support are provided by optional libraries, which can be installed at will.</p>  <p>So I removed the X11 and esound features from the main <code>kaffe</code> package, while doing some cleanup.  Then, I removed the oddly named <code>kaffe-nox11</code> package and added two more: <code>kaffe-x11</code> and <code>kaffe-esound</code>. These two depend on the base package, and there are no conflicts between them at all. What they do is build and install the specific shared libraries needed to add these features, which are later loaded by Kaffe at runtime.</p>  <p>You see, problem gone. No more conflicts and people using binary packages have a choice about what they want to run on their systems ;-) Keep this in mind if you ever plan to help pkgsrc.</p><p class="mobile-post"></p>
