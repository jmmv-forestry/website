---
layout: post
title: "Java: Dynamic class loading, part 2"
date: 2005-11-20 12:59:00 -0500
categories:
julipedia: 2005/11/java-dynamic-class-loading-part-2.html
excerpt_separator: </p>
---
As we saw in a <a href="http://julipedia.blogspot.com/2005/10/java-dynamic-class-loading.html">previous post</a>, Java has the ability to dynamically load classes based on their name.  We previously assumed that the classes being loaded had a constructor with no arguments. However, this restriction is ficticious. Let's now see how to load a class with random constructors.<br /><br />The first thing we have to do is to create a vector of <tt>Class</tt> objects that describes the constructors' prototype. Each element corresponds to a function parameter. Similarly, we later create a vector of <tt>Object</tt> instances that represents the parameters' values. For example, let's consider the following class:<pre>public class FooClass {<br />    public FooClass(String a, Integer b) {<br />        ...<br />    }<br />}</pre>Having this, we'd do the following to prepare the call:<pre>Class[] proto = new Class[2];<br />proto[0] = String.class;<br />proto[1] = Integer.class;<br /><br />Object[] params = new Object[2];<br />params[0] = "foo";<br />params[1] = new Integer(5);</pre>Once we have this, we can proceed to create the instance of the desired class. To do this, we start by loading the class as we did in the former post. With the class loaded (as a <tt>Class</tt> object), we use the <tt>getConstructor</tt> method using the constructor's prototype (<tt>proto</tt> variable) as its single argument; this returns a <tt>Constructor</tt> object that represents the desired method.<br /><br />At last, we call the <tt>newInstance</tt> function over the <tt>Constructor</tt> object to create a new instance of the requested class (<tt>FooClass</tt> in our example). Shown as real code:<pre>Class c = Class.forName("FooClass");<br />Constructor ct = c.getConstructor(proto);<br />FooClass fc = (FooClass)ct.newInstance(params);</pre>Note that I've used the <tt>Integer</tt> class rather than the primitive <tt>int</tt> type; I'm not yet sure if you can dynamically call a function that uses primitive types in its signature. Also note that the class being loaded, as well as its constructor, are declared public; otherwise, the load will fail.
