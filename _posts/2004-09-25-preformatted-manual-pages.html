---
layout: post
title: "Preformatted manual pages"
date: 2004-09-25 09:29:00 -0400
categories:
julipedia: 2004/09/preformatted-manual-pages.html
excerpt_separator: </p>
---
<p>Some time ago, a friend of mine installed <a href="http://www.freebsd.org/">FreeBSD</a> on his old laptop and told me that it was very slow.  Specially, a simple <tt>man ls</tt> took forever, while the same command on a Linux system went faster. Why was this specific command slower? Probably because he missed to install the <i>preformatted manual pages</i>, included in the <tt>catman</tt> series.</p>  <p>We'll see what these files are in a minute, but first of all you have to understand how <tt>man</tt> works.  Manual pages are stored under <tt>/usr/share/man/man[1-8]</tt> (among other customizable locations). The files in these directories are the manual pages in their source code form, that is, in <tt>groff</tt> format (or some other flavour of <tt>roff</tt>, depending on the system).</p>  <p>Whenever you ask for a manual page, <tt>man</tt> invokes <tt>groff</tt> to generate a pretty formatted page: it indents and fills paragraphs, changes some text into boldface, etc. (As an analogy, it is like the conversion from plain HTML code to the rendered page.) When the conversion has finished, <tt>more</tt> (or the program pointed by the <tt>PAGER</tt> variable) is invoked to show you the generated page.</p>  <p>This process can be very slow on old systems. So, if the source pages don't change often, why not store a copy of the generated files somewhere in the system? This way, they can be accessed at will, without having to call <tt>groff</tt>.  This is exactly what preformatted manual pages are for.</p>  <p>On a BSD system, if you look at the files stored in <tt>/usr/share/man/cat[1-8]</tt> (assuming you installed them), you'll see that they are the pretty formatted version of your manual pages. These where generated when the whole system was built, so that the conversion has to happen only once. If they are there, <tt>man</tt> will prefer them over the source pages to speed up its process.</p>  <p>On a Linux system, things work in a slightly different way.  The preformatted pages are stored under <tt>/var/cache/man/cat[1-8]</tt>, and are generated on the first read; therefore, further reads of the same manual page will be very fast. However, this only happens if the <tt>man</tt> program has the setuid bit set, or if you have enough permissions to write to that directory.  Check the <tt>man(1)</tt> manual page for more information about how this works. (I'm not completely sure that this is the exact process... correct me if I'm wrong, please.)</p><p class="mobile-post"></p>
