---
layout: post
title: "NetBSD/mac68k soft-float support"
date: 2004-09-28 12:51:00 -0400
categories:
julipedia: 2004/09/netbsdmac68k-soft-float-support.html
excerpt_separator: </p>
---
<p>Two days ago I commited some code to <a href="http://www.netbsd.org/">NetBSD</a>'s CVS HEAD to let the <a href="http://www.netbsd.org/Ports/mac68k/">mac68k</a> port be built with soft-float support. All this work was originally done by Bruce O'Neel, so if you want to thank somebody, thank him. In order to build a release with this feature enabled, it's as easy as passing the <tt>-V MKSOFTFLOAT=yes</tt> argument to the <tt>build.sh</tt> script.</p>  <p>But what's known as soft-float? Simply put, it's a way to build binaries that do not use the FPU at all. The GCC compiler has an special option to do this, named <tt>-msoft-float</tt>. When used, it translates all FPU instructions into calls to regular subroutines (provided in the C library), which provide emulation code.</p>  <p>Ok but... why is soft-float useful in the mac68k port? The 60840LC chip has a hardware bug that makes it impossible to implement an FPU emulator in kernel space; this chip is included in many Macintosh boxes, like the Performa 630 I have. (AFAIUI, there is a way to workaround this issue, but it's not implemented in NetBSD...) So, by using a NetBSD release built with soft-float, you can run it on one of those computers! Isn't it cool? ;-)</p><p class="mobile-post"></p>
